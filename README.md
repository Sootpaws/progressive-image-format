# Progressive Streamable Image Format

## Overview

Progressive Streamable Image (or PSI) is a proof-of-concept lossless image
format that allows the image to be displayed at progressively higher resolutions
while being loaded. This prevents the "dial-up" effect where media loads from
top to bottom, potentially hiding more relevent portions until the top part
loads. Additionally, if the image is being displayed at a significantly lower
resolution to the source data, loading can be stopped or deprioritized once the
image has been loaded to a high-enough resolution, potentially saving a
significant amount of unneeded data transfer.

## Prior Work

The Progressive JPEG format appears to be a reasonable implementation of this
concept, however it is a lossy format.

## Concept

Rather than directly encode the pixel data, PSI represents the image as a series
of *layers* of approximately doubling resolution, and only stores the
*difference* between progressive layers. These are stored from smallest to
largest, and then successively applied to reconstruct the original image. Each
layer is half the size of the previous (rounded up), and each block of four
pixels on the layer are diffed to the single pixel that they replace on the
previous layer. Each diff value is generated by subtracting the pixel on the
current layer from the one on the previous one, adding `0x7f`, and clamping to
0..255.

## Binary Format

Header:
- Magic (4 bytes): `0x00 0x50 0x53 0x49` - <null>PSI in ASCII
- Full width (BE u16) - Width of the full image in pixels
- Full height (BE u16) - Height of the full image in pixels
- Layer diffs:
    - Layer header (1 byte) - `M` in ASCII
    - Pixels (left to right, top to bottom):
        - Pixel diff in RGBA order, 1 byte per channel

## Comparisons and Analysis

## Simple Image Format

SIF is just about the simplest and most inefficient bitmap image format
possible, and is used here as a baseline to compare against.
The format is as follows:

Header:
- Full width (BE u16) - Width of the full image in pixels
- Full height (BE u16) - Height of the full image in pixels
- Pixels (left to right, top to bottom):
    - Pixel value in RGBA order, 1 byte unsigned per channel

## Limitations

As this is only a proof-of-concept, there are numerous areas of potential
improvement. The most notable are as follows:

- Implementation
    - Resizability of rendered images - Images are rendered to a preset
        resolution and cannot be loaded further if the image scale is increased
    - Performance - Both the encoding and decoding/rendering have extremely poor
        preformance, and could be significantly optimized
    - Integration - The Javascript rendering system is difficult integrate into
        a standard webpage
- Analysis
    - Limited range of comparison samples - Although the images chosen for the
        demo and efficiency comparison are intended to cover a broad range of
        scenarios, an analysis of potential gains in a real-world environment
        would be much more conclusive
- Format
    - Fixed pixel format - All images are 8 bits per channel RGBA, but other
        formats exist and supporting them should be considered
    - No additional metadata - Most image formats support metadata for
        properties like color space, which are not currently part of
        the PSI format
    - No compression - Standard formats employ data compression algorithms to
        reduce data size, which could be applied
